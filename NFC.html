<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Tag NFC Writer</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet"/>
<style>
  :root {
    --primary: #7f56d9;
    --accent: #9e77ed;
    --bg: #f9fafb;
    --card: #fff;
    --border: #e5e7eb;
    --text: #1f2937;
    --muted: #6b7280;
  }
  body {
    background: var(--bg);
    font-family: 'Inter', sans-serif;
    margin: 0;
    padding: 20px;
    text-align: center;
  }
  .banner {
    display: none;
    margin-bottom: 15px;
    padding: 12px;
    background: #fef3c7;
    border: 1px solid #fcd34d;
    color: #92400e;
    border-radius: 12px;
  }
  .container {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 16px;
    max-width: 600px;
    margin: auto;
    padding: 30px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.05);
  }
  h1 { margin: 0; font-size: 1.5em; color: var(--text); }
  .grid {
    display: grid;
    grid-template-columns: repeat(3,1fr);
    gap: 15px;
    margin: 20px 0;
  }
  .option {
    background: #f3f4f6;
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 14px;
    cursor: pointer;
    transition: background .2s;
  }
  .option:hover { background: #ede9fe; }
  .option svg {
    width: 28px;
    height: 28px;
    fill: var(--primary);
    margin-bottom: 6px;
  }
  .option span {
    display: block;
    font-size: .85em;
    color: var(--text);
  }
  .fields { margin-bottom: 20px; }
  .fields input, .fields select {
    width: 100%;
    padding: 12px;
    font-size: 1em;
    margin-bottom: 10px;
    border: 1px solid var(--border);
    border-radius: 10px;
  }
  button {
    width: 100%;
    padding: 14px;
    font-size: 1em;
    color: #fff;
    background: linear-gradient(to right, var(--primary), var(--accent));
    border: none;
    border-radius: 10px;
    font-weight: 600;
    cursor: pointer;
  }
  .status { margin-top: 15px; font-size: .9em; color: var(--muted); }
  .cta {
    background: #ede9fe;
    border: 1px solid #dcd3f6;
    border-radius: 14px;
    margin-top: 30px;
    padding: 20px;
  }
  .cta a {
    display: inline-block;
    margin-top: 8px;
    padding: 12px 20px;
    background: linear-gradient(to right, var(--primary), var(--accent));
    color: #fff;
    border-radius: 10px;
    text-decoration: none;
    font-weight: 600;
  }
  .ads-placeholder {
    background: #fff;
    border: 1px solid var(--border);
    border-radius: 10px;
    margin: 20px 0;
    padding: 15px;
  }
  .popup {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.4);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 999;
  }
  .popup-content {
    background: #fff;
    padding: 20px 30px;
    border-radius: 14px;
    text-align: center;
  }
  .popup-content svg {
    fill: var(--primary);
    width: 40px;
    height: 40px;
    margin-bottom: 10px;
  }
</style>
</head>
<body>
  <div class="banner" id="nfcBanner">
    üîí Web NFC not supported. Use <strong>Chrome on Android</strong> over HTTPS.
  </div>

  <div class="container">
    <h1>Write NFC Tag</h1>
    <div class="grid">
      <div class="option" onclick="selectType('url')">
        <svg viewBox="0 0 24 24"><path d="M3.9 12A5.1 5.1 0 119.0 6.9h1.5a1 1 0 000-2H9A7.1 7.1 0 103.9 12zm8.2 0a1 1 0 012 0 3.1 3.1 0 11-3.1-3.1H9a1 1 0 000 2h3.1z"/></svg>
        <span>Link</span>
      </div>
      <div class="option" onclick="selectType('phone')">
        <svg viewBox="0 0 24 24"><path d="M6.62 10.8a15.9 15.9 0 006.6 6.6l2.2-2.2a1 1 0 011-.2 11.4 11.4 0 003.6.6 1 1 0 011 1V20a1 1 0 01-1 1A16 16 0 013 5a1 1 0 011-1h3.5a1 1 0 011 1 11.4 11.4 0 00.6 3.6 1 1 0 01-.2 1z"/></svg>
        <span>Phone</span>
      </div>
      <div class="option" onclick="selectType('email')">
        <svg viewBox="0 0 24 24"><path d="M20 4H4a2 2 0 00-2 2v12a2 2 0 002 2h16a2 2 0 002-2V6a2 2 0 00-2-2zm0 4l-8 5-8-5"/></svg>
        <span>Email</span>
      </div>
      <div class="option" onclick="selectType('wifi')">
        <svg viewBox="0 0 24 24"><path d="M12 20a1.5 1.5 0 011.1-2.6 1.5 1.5 0 11-2.2 0A1.5 1.5 0 0112 20z"/><path d="M4.2 14.2a5 5 0 017.1 0 1 1 0 01-1.4 1.4 3 3 0 00-4.2 0 1 1 0 11-1.4-1.4z"/><path d="M2.1 10.1a9 9 0 0112.7 0 1 1 0 01-1.4 1.4 7 7 0 00-9.9 0 1 1 0 11-1.4-1.4z"/></svg>
        <span>WiFi</span>
      </div>
      <div class="option" onclick="selectType('text')">
        <svg viewBox="0 0 24 24"><path d="M4 4h16v2H4zm0 4h16v12H4z"/></svg>
        <span>Text</span>
      </div>
    </div>

    <div class="fields" id="inputFields"></div>
    <button onclick="writeToNFC()">Write to NFC Tag</button>
    <div class="status" id="status"></div>

    <div class="ads-placeholder">Ads Here</div>

    <div class="cta">
      <strong>Want scheduling or analytics?</strong><br>
      Get advanced features like tag scheduling, tracking, and analytics.<br>
      <a href="https://www.taggy.digital" target="_blank">Go to Taggy.digital</a>
    </div>
  </div>

  <div class="popup" id="popup"><div class="popup-content" id="popupContent"></div></div>

<script>
let currentType = '';
window.addEventListener('DOMContentLoaded', () => {
  if (!('NDEFReader' in window)) document.getElementById('nfcBanner').style.display = 'block';
});

function selectType(type) {
  currentType = type;
  const c = document.getElementById('inputFields');
  c.innerHTML = '';
  if (type === 'url') c.innerHTML = '<input id="input1" placeholder="https://example.com"/>';
  if (type === 'phone') c.innerHTML = '<input id="input1" placeholder="+1234567890"/>';
  if (type === 'email') c.innerHTML = '<input id="input1" placeholder="user@example.com"/>';
  if (type === 'text') c.innerHTML = '<input id="input1" placeholder="Your message"/>';
  if (type === 'wifi') c.innerHTML = `
    <input id="input1" placeholder="SSID"/>
    <input id="input2" placeholder="Password"/>
    <select id="input3" onchange="togglePwd(this)">
      <option value="WPA" selected>WPA</option>
      <option value="WEP">WEP</option>
      <option value="nopass">No Password</option>
    </select>`;
}

function togglePwd(sel) {
  document.getElementById('input2').style.display = sel.value === 'nopass' ? 'none' : 'block';
}

function showPopup(text, tick=false) {
  const pop = document.getElementById('popup');
  const c = document.getElementById('popupContent');
  c.innerHTML = (tick ? '<svg viewBox="0 0 24 24"><path d="M5 13l4 4L19 7"/></svg>' : '') + `<div>${text}</div>`;
  pop.style.display = 'flex';
  setTimeout(() => pop.style.display = 'none', 2500);
}

async function writeToNFC(){
  const s = document.getElementById('status');
  if (!('NDEFReader' in window)) { s.textContent = '‚ùå Not supported.'; return; }

  const val1 = document.getElementById('input1')?.value.trim() || '';
  const val2 = document.getElementById('input2')?.value.trim() || '';
  const val3 = document.getElementById('input3')?.value;
  if (!val1 && currentType !== 'wifi') return s.textContent='‚ö†Ô∏è Fill required fields.';

  let payload = '';
  if (currentType === 'url') payload = val1;
  if (currentType === 'phone') payload = `tel:${val1}`;
  if (currentType === 'email') payload = `mailto:${val1}`;
  if (currentType === 'text') payload = val1;
  if (currentType === 'wifi') payload = `WIFI:S:${val1};T:${val3};P:${val3==='nopass'?'' : val2};;`;

  try {
    const ndef = new NDEFReader();
    const os = /android/i.test(navigator.userAgent) ? 'Android' : 'iOS/other';
    showPopup(`Hold your ${os} device near the tag‚Ä¶`);
    await ndef.write({ records:[{recordType:'url',data:payload}] });
    s.textContent = '‚úÖ Tag written!';
    showPopup('Done!', true);
  } catch(err) {
    console.error(err);
    document.getElementById('nfcBanner').textContent = '‚ùå Write failed‚Äîenable NFC and tap again.';
    document.getElementById('nfcBanner').style.display='block';
  }
}
</script>
</body>
</html>
